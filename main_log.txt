Matplotlib created a temporary config/cache directory at /tmp/matplotlib-3w3y_h1n because the default path (/nfs/home/.local/bin/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
2025-03-24 01:59:21.208518: I tensorflow/core/platform/cpu_feature_guard.cc:194] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Data loading ...
Done!
Loss Function:  bce
Metrics:  {'accuracy': 1, 'cf_matrix': 1, 'f1': 1, 'specificity': 1, 'AUC': 1}
/usr/local/lib/python3.8/dist-packages/lightning_fabric/connector.py:571: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-SXM4-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/usr/local/lib/python3.8/dist-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type           | Params | Mode 
---------------------------------------------------
0 | model   | CompeleteModel | 11.2 M | train
1 | metrics | ModuleDict     | 0      | train
---------------------------------------------------
11.2 M    Trainable params
0         Non-trainable params
11.2 M    Total params
44.682    Total estimated model params size (MB)
88        Modules in train mode
0         Modules in eval mode
/usr/local/lib/python3.8/dist-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (15) is smaller than the logging interval Trainer(log_every_n_steps=200). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/15 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/15 [00:00<?, ?it/s] <class 'torch.Tensor'>
Epoch 0:   7%|▋         | 1/15 [00:00<00:08,  1.65it/s]Epoch 0:   7%|▋         | 1/15 [00:00<00:08,  1.65it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  13%|█▎        | 2/15 [00:00<00:04,  2.83it/s, v_num=1]Epoch 0:  13%|█▎        | 2/15 [00:00<00:04,  2.83it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  20%|██        | 3/15 [00:00<00:03,  3.74it/s, v_num=1]Epoch 0:  20%|██        | 3/15 [00:00<00:03,  3.74it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  27%|██▋       | 4/15 [00:00<00:02,  4.50it/s, v_num=1]Epoch 0:  27%|██▋       | 4/15 [00:00<00:02,  4.49it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  33%|███▎      | 5/15 [00:00<00:01,  5.12it/s, v_num=1]Epoch 0:  33%|███▎      | 5/15 [00:00<00:01,  5.12it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  40%|████      | 6/15 [00:01<00:01,  5.64it/s, v_num=1]Epoch 0:  40%|████      | 6/15 [00:01<00:01,  5.64it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  47%|████▋     | 7/15 [00:01<00:01,  6.08it/s, v_num=1]Epoch 0:  47%|████▋     | 7/15 [00:01<00:01,  6.08it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  53%|█████▎    | 8/15 [00:01<00:01,  6.46it/s, v_num=1]Epoch 0:  53%|█████▎    | 8/15 [00:01<00:01,  6.46it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  60%|██████    | 9/15 [00:01<00:00,  6.80it/s, v_num=1]Epoch 0:  60%|██████    | 9/15 [00:01<00:00,  6.79it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  67%|██████▋   | 10/15 [00:01<00:00,  7.09it/s, v_num=1]Epoch 0:  67%|██████▋   | 10/15 [00:01<00:00,  7.09it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  73%|███████▎  | 11/15 [00:01<00:00,  7.35it/s, v_num=1]Epoch 0:  73%|███████▎  | 11/15 [00:01<00:00,  7.35it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  80%|████████  | 12/15 [00:01<00:00,  7.59it/s, v_num=1]Epoch 0:  80%|████████  | 12/15 [00:01<00:00,  7.59it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  87%|████████▋ | 13/15 [00:01<00:00,  7.79it/s, v_num=1]Epoch 0:  87%|████████▋ | 13/15 [00:01<00:00,  7.79it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0:  93%|█████████▎| 14/15 [00:01<00:00,  7.99it/s, v_num=1]Epoch 0:  93%|█████████▎| 14/15 [00:01<00:00,  7.98it/s, v_num=1]<class 'torch.Tensor'>
Epoch 0: 100%|██████████| 15/15 [00:01<00:00,  8.34it/s, v_num=1]Epoch 0: 100%|██████████| 15/15 [00:01<00:00,  8.33it/s, v_num=1]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 38.51it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 40.51it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 41.00it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 41.52it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 41.85it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.08it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 42.86it/s][AMetric valid_loss improved. New best score: 0.694

                                                                      [AEpoch 0: 100%|██████████| 15/15 [00:02<00:00,  5.85it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000]Epoch 0, global step 15: 'valid_loss' reached 0.69355 (best 0.69355), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=00-valid_loss=0.693545-valid_accuracy=0.508413.ckpt' as top 3
Epoch 0: 100%|██████████| 15/15 [00:03<00:00,  4.37it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000]Epoch 0:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000]         Epoch 1:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000]<class 'torch.Tensor'>
Epoch 1:   7%|▋         | 1/15 [00:00<00:03,  4.29it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000]Epoch 1:   7%|▋         | 1/15 [00:00<00:03,  4.28it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  13%|█▎        | 2/15 [00:00<00:02,  6.25it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  13%|█▎        | 2/15 [00:00<00:02,  6.25it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  20%|██        | 3/15 [00:00<00:01,  7.39it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  20%|██        | 3/15 [00:00<00:01,  7.39it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  27%|██▋       | 4/15 [00:00<00:01,  8.14it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  27%|██▋       | 4/15 [00:00<00:01,  8.13it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  33%|███▎      | 5/15 [00:00<00:01,  8.67it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  33%|███▎      | 5/15 [00:00<00:01,  8.66it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  40%|████      | 6/15 [00:00<00:00,  9.05it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  40%|████      | 6/15 [00:00<00:00,  9.04it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  47%|████▋     | 7/15 [00:00<00:00,  9.34it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  47%|████▋     | 7/15 [00:00<00:00,  9.34it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  53%|█████▎    | 8/15 [00:00<00:00,  9.59it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  53%|█████▎    | 8/15 [00:00<00:00,  9.59it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  60%|██████    | 9/15 [00:00<00:00,  9.79it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  60%|██████    | 9/15 [00:00<00:00,  9.79it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  67%|██████▋   | 10/15 [00:01<00:00,  9.96it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  67%|██████▋   | 10/15 [00:01<00:00,  9.96it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  73%|███████▎  | 11/15 [00:01<00:00, 10.11it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  73%|███████▎  | 11/15 [00:01<00:00, 10.11it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  80%|████████  | 12/15 [00:01<00:00, 10.23it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  80%|████████  | 12/15 [00:01<00:00, 10.23it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  87%|████████▋ | 13/15 [00:01<00:00, 10.34it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  87%|████████▋ | 13/15 [00:01<00:00, 10.34it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1:  93%|█████████▎| 14/15 [00:01<00:00, 10.44it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:  93%|█████████▎| 14/15 [00:01<00:00, 10.43it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 1: 100%|██████████| 15/15 [00:01<00:00, 11.04it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1: 100%|██████████| 15/15 [00:01<00:00, 11.04it/s, v_num=1, valid_loss=0.694, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 40.50it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.64it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.06it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.32it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.46it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.50it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.69it/s][A
                                                                      [AEpoch 1: 100%|██████████| 15/15 [00:01<00:00,  8.18it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1, global step 30: 'valid_loss' reached 0.76500 (best 0.69355), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=01-valid_loss=0.764996-valid_accuracy=0.508413.ckpt' as top 3
Epoch 1: 100%|██████████| 15/15 [00:02<00:00,  5.61it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 1:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]         Epoch 2:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]<class 'torch.Tensor'>
Epoch 2:   7%|▋         | 1/15 [00:00<00:03,  4.18it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.680, train_accuracy=0.530, train_specificity=0.649, train_AUC=0.506, train_f1=0.390]Epoch 2:   7%|▋         | 1/15 [00:00<00:03,  4.17it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  13%|█▎        | 2/15 [00:00<00:02,  6.14it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  13%|█▎        | 2/15 [00:00<00:02,  6.14it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  20%|██        | 3/15 [00:00<00:01,  7.28it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  20%|██        | 3/15 [00:00<00:01,  7.27it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  27%|██▋       | 4/15 [00:00<00:01,  8.02it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  27%|██▋       | 4/15 [00:00<00:01,  8.02it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  33%|███▎      | 5/15 [00:00<00:01,  8.55it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  33%|███▎      | 5/15 [00:00<00:01,  8.55it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  40%|████      | 6/15 [00:00<00:01,  8.94it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  40%|████      | 6/15 [00:00<00:01,  8.94it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  47%|████▋     | 7/15 [00:00<00:00,  9.13it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  47%|████▋     | 7/15 [00:00<00:00,  9.13it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  53%|█████▎    | 8/15 [00:00<00:00,  9.39it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  53%|█████▎    | 8/15 [00:00<00:00,  9.39it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  60%|██████    | 9/15 [00:00<00:00,  9.62it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  60%|██████    | 9/15 [00:00<00:00,  9.62it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  67%|██████▋   | 10/15 [00:01<00:00,  9.80it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  67%|██████▋   | 10/15 [00:01<00:00,  9.80it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  73%|███████▎  | 11/15 [00:01<00:00,  9.95it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  73%|███████▎  | 11/15 [00:01<00:00,  9.95it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  80%|████████  | 12/15 [00:01<00:00, 10.08it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  80%|████████  | 12/15 [00:01<00:00, 10.08it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  87%|████████▋ | 13/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  87%|████████▋ | 13/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2:  93%|█████████▎| 14/15 [00:01<00:00, 10.24it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:  93%|█████████▎| 14/15 [00:01<00:00, 10.23it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 2: 100%|██████████| 15/15 [00:01<00:00, 10.83it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2: 100%|██████████| 15/15 [00:01<00:00, 10.83it/s, v_num=1, valid_loss=0.765, valid_accuracy=0.508, valid_specificity=1.000, valid_AUC=0.500, valid_f1=0.000, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.64it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.97it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.34it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.52it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 40.89it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 39.74it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 42.91it/s][A
                                                                      [AEpoch 2: 100%|██████████| 15/15 [00:01<00:00,  7.76it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2, global step 45: 'valid_loss' reached 0.75976 (best 0.69355), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=02-valid_loss=0.759762-valid_accuracy=0.510383.ckpt' as top 3
Epoch 2: 100%|██████████| 15/15 [00:02<00:00,  5.31it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 2:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]         Epoch 3:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]<class 'torch.Tensor'>
Epoch 3:   7%|▋         | 1/15 [00:00<00:03,  4.24it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.618, train_accuracy=0.691, train_specificity=0.911, train_AUC=0.646, train_f1=0.505]Epoch 3:   7%|▋         | 1/15 [00:00<00:03,  4.23it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  13%|█▎        | 2/15 [00:00<00:02,  6.22it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  13%|█▎        | 2/15 [00:00<00:02,  6.22it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  20%|██        | 3/15 [00:00<00:01,  7.39it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  20%|██        | 3/15 [00:00<00:01,  7.38it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  27%|██▋       | 4/15 [00:00<00:01,  8.13it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  27%|██▋       | 4/15 [00:00<00:01,  8.13it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  33%|███▎      | 5/15 [00:00<00:01,  8.65it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  33%|███▎      | 5/15 [00:00<00:01,  8.64it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  40%|████      | 6/15 [00:00<00:00,  9.04it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  40%|████      | 6/15 [00:00<00:00,  9.03it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  47%|████▋     | 7/15 [00:00<00:00,  9.34it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  47%|████▋     | 7/15 [00:00<00:00,  9.33it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  53%|█████▎    | 8/15 [00:00<00:00,  9.57it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  53%|█████▎    | 8/15 [00:00<00:00,  9.56it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  60%|██████    | 9/15 [00:00<00:00,  9.76it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  60%|██████    | 9/15 [00:00<00:00,  9.76it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  67%|██████▋   | 10/15 [00:01<00:00,  9.93it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  67%|██████▋   | 10/15 [00:01<00:00,  9.92it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  73%|███████▎  | 11/15 [00:01<00:00, 10.07it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  73%|███████▎  | 11/15 [00:01<00:00, 10.06it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  80%|████████  | 12/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  80%|████████  | 12/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  87%|████████▋ | 13/15 [00:01<00:00, 10.30it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  87%|████████▋ | 13/15 [00:01<00:00, 10.29it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3:  93%|█████████▎| 14/15 [00:01<00:00, 10.39it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:  93%|█████████▎| 14/15 [00:01<00:00, 10.39it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 3: 100%|██████████| 15/15 [00:01<00:00, 10.99it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3: 100%|██████████| 15/15 [00:01<00:00, 10.99it/s, v_num=1, valid_loss=0.760, valid_accuracy=0.510, valid_specificity=1.000, valid_AUC=0.502, valid_f1=0.00859, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 42.12it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 42.42it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.53it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.66it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.74it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.80it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.96it/s][A
                                                                      [AEpoch 3: 100%|██████████| 15/15 [00:01<00:00,  8.11it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638] Epoch 3, global step 60: 'valid_loss' reached 0.74977 (best 0.69355), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=03-valid_loss=0.749772-valid_accuracy=0.524178.ckpt' as top 3
Epoch 3: 100%|██████████| 15/15 [00:02<00:00,  5.46it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 3:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]         Epoch 4:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]<class 'torch.Tensor'>
Epoch 4:   7%|▋         | 1/15 [00:00<00:03,  3.89it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.566, train_accuracy=0.736, train_specificity=0.859, train_AUC=0.711, train_f1=0.638]Epoch 4:   7%|▋         | 1/15 [00:00<00:03,  3.89it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  13%|█▎        | 2/15 [00:00<00:02,  5.83it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  13%|█▎        | 2/15 [00:00<00:02,  5.83it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  20%|██        | 3/15 [00:00<00:01,  7.01it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  20%|██        | 3/15 [00:00<00:01,  7.01it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  27%|██▋       | 4/15 [00:00<00:01,  7.79it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  27%|██▋       | 4/15 [00:00<00:01,  7.78it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  33%|███▎      | 5/15 [00:00<00:01,  8.33it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  33%|███▎      | 5/15 [00:00<00:01,  8.33it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  40%|████      | 6/15 [00:00<00:01,  8.73it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  40%|████      | 6/15 [00:00<00:01,  8.73it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  47%|████▋     | 7/15 [00:00<00:00,  8.91it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  47%|████▋     | 7/15 [00:00<00:00,  8.91it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  53%|█████▎    | 8/15 [00:00<00:00,  9.19it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  53%|█████▎    | 8/15 [00:00<00:00,  9.19it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  60%|██████    | 9/15 [00:00<00:00,  9.41it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  60%|██████    | 9/15 [00:00<00:00,  9.41it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  67%|██████▋   | 10/15 [00:01<00:00,  9.60it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  67%|██████▋   | 10/15 [00:01<00:00,  9.60it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  73%|███████▎  | 11/15 [00:01<00:00,  9.76it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  73%|███████▎  | 11/15 [00:01<00:00,  9.76it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  80%|████████  | 12/15 [00:01<00:00,  9.89it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  80%|████████  | 12/15 [00:01<00:00,  9.89it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  87%|████████▋ | 13/15 [00:01<00:00, 10.01it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  87%|████████▋ | 13/15 [00:01<00:00, 10.01it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4:  93%|█████████▎| 14/15 [00:01<00:00, 10.12it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:  93%|█████████▎| 14/15 [00:01<00:00, 10.12it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 4: 100%|██████████| 15/15 [00:01<00:00, 10.72it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4: 100%|██████████| 15/15 [00:01<00:00, 10.71it/s, v_num=1, valid_loss=0.750, valid_accuracy=0.524, valid_specificity=0.993, valid_AUC=0.516, valid_f1=0.0754, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.91it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.89it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.07it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.16it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.35it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.45it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.60it/s][A
                                                                      [AEpoch 4: 100%|██████████| 15/15 [00:01<00:00,  7.94it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671] Epoch 4, global step 75: 'valid_loss' reached 0.73657 (best 0.69355), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=04-valid_loss=0.736572-valid_accuracy=0.546157.ckpt' as top 3
Epoch 4: 100%|██████████| 15/15 [00:02<00:00,  5.41it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 4:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]         Epoch 5:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]<class 'torch.Tensor'>
Epoch 5:   7%|▋         | 1/15 [00:00<00:03,  3.95it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.554, train_accuracy=0.751, train_specificity=0.850, train_AUC=0.731, train_f1=0.671]Epoch 5:   7%|▋         | 1/15 [00:00<00:03,  3.95it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  13%|█▎        | 2/15 [00:00<00:02,  5.87it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  13%|█▎        | 2/15 [00:00<00:02,  5.87it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  20%|██        | 3/15 [00:00<00:01,  7.02it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  20%|██        | 3/15 [00:00<00:01,  7.01it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  27%|██▋       | 4/15 [00:00<00:01,  7.77it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  27%|██▋       | 4/15 [00:00<00:01,  7.77it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  33%|███▎      | 5/15 [00:00<00:01,  8.30it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  33%|███▎      | 5/15 [00:00<00:01,  8.30it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  40%|████      | 6/15 [00:00<00:01,  8.70it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  40%|████      | 6/15 [00:00<00:01,  8.70it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  47%|████▋     | 7/15 [00:00<00:00,  9.00it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  47%|████▋     | 7/15 [00:00<00:00,  9.00it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  53%|█████▎    | 8/15 [00:00<00:00,  9.26it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  53%|█████▎    | 8/15 [00:00<00:00,  9.25it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  60%|██████    | 9/15 [00:00<00:00,  9.48it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  60%|██████    | 9/15 [00:00<00:00,  9.48it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  67%|██████▋   | 10/15 [00:01<00:00,  9.67it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  67%|██████▋   | 10/15 [00:01<00:00,  9.67it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  73%|███████▎  | 11/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  73%|███████▎  | 11/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  80%|████████  | 12/15 [00:01<00:00,  9.98it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  80%|████████  | 12/15 [00:01<00:00,  9.98it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  87%|████████▋ | 13/15 [00:01<00:00, 10.10it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  87%|████████▋ | 13/15 [00:01<00:00, 10.10it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5:  93%|█████████▎| 14/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:  93%|█████████▎| 14/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 5: 100%|██████████| 15/15 [00:01<00:00, 10.78it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5: 100%|██████████| 15/15 [00:01<00:00, 10.78it/s, v_num=1, valid_loss=0.737, valid_accuracy=0.546, valid_specificity=0.991, valid_AUC=0.539, valid_f1=0.157, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.60it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 42.10it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.37it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.54it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.61it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.40it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.34it/s][A
                                                                      [AEpoch 5: 100%|██████████| 15/15 [00:01<00:00,  7.83it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5, global step 90: 'valid_loss' reached 0.67172 (best 0.67172), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=05-valid_loss=0.671725-valid_accuracy=0.607700.ckpt' as top 3
Epoch 5: 100%|██████████| 15/15 [00:03<00:00,  4.56it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 5:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]         Epoch 6:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]<class 'torch.Tensor'>
Epoch 6:   7%|▋         | 1/15 [00:00<00:03,  3.75it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.536, train_accuracy=0.764, train_specificity=0.856, train_AUC=0.745, train_f1=0.690]Epoch 6:   7%|▋         | 1/15 [00:00<00:03,  3.74it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  13%|█▎        | 2/15 [00:00<00:02,  5.44it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  13%|█▎        | 2/15 [00:00<00:02,  5.44it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  20%|██        | 3/15 [00:00<00:01,  6.48it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  20%|██        | 3/15 [00:00<00:01,  6.48it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  27%|██▋       | 4/15 [00:00<00:01,  7.29it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  27%|██▋       | 4/15 [00:00<00:01,  7.28it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  33%|███▎      | 5/15 [00:00<00:01,  7.87it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  33%|███▎      | 5/15 [00:00<00:01,  7.87it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  40%|████      | 6/15 [00:00<00:01,  8.32it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  40%|████      | 6/15 [00:00<00:01,  8.32it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  47%|████▋     | 7/15 [00:00<00:00,  8.66it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  47%|████▋     | 7/15 [00:00<00:00,  8.65it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  53%|█████▎    | 8/15 [00:00<00:00,  8.93it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  53%|█████▎    | 8/15 [00:00<00:00,  8.93it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  60%|██████    | 9/15 [00:00<00:00,  9.16it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  60%|██████    | 9/15 [00:00<00:00,  9.15it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  67%|██████▋   | 10/15 [00:01<00:00,  9.36it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  67%|██████▋   | 10/15 [00:01<00:00,  9.36it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  73%|███████▎  | 11/15 [00:01<00:00,  9.53it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  73%|███████▎  | 11/15 [00:01<00:00,  9.53it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  80%|████████  | 12/15 [00:01<00:00,  9.67it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  80%|████████  | 12/15 [00:01<00:00,  9.67it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  87%|████████▋ | 13/15 [00:01<00:00,  9.81it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  87%|████████▋ | 13/15 [00:01<00:00,  9.80it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6:  93%|█████████▎| 14/15 [00:01<00:00,  9.92it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:  93%|█████████▎| 14/15 [00:01<00:00,  9.92it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 6: 100%|██████████| 15/15 [00:01<00:00, 10.48it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6: 100%|██████████| 15/15 [00:01<00:00, 10.48it/s, v_num=1, valid_loss=0.672, valid_accuracy=0.608, valid_specificity=0.898, valid_AUC=0.603, valid_f1=0.435, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 40.17it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.21it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 41.80it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.07it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.02it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.09it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.21it/s][A
                                                                      [AEpoch 6: 100%|██████████| 15/15 [00:01<00:00,  7.60it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6, global step 105: 'valid_loss' reached 0.64653 (best 0.64653), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=06-valid_loss=0.646529-valid_accuracy=0.634228.ckpt' as top 3
Epoch 6: 100%|██████████| 15/15 [00:02<00:00,  5.19it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 6:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]         Epoch 7:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]<class 'torch.Tensor'>
Epoch 7:   7%|▋         | 1/15 [00:00<00:03,  4.05it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.521, train_accuracy=0.782, train_specificity=0.858, train_AUC=0.766, train_f1=0.720]Epoch 7:   7%|▋         | 1/15 [00:00<00:03,  4.04it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  13%|█▎        | 2/15 [00:00<00:02,  6.01it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  13%|█▎        | 2/15 [00:00<00:02,  6.00it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  20%|██        | 3/15 [00:00<00:01,  7.15it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  20%|██        | 3/15 [00:00<00:01,  7.15it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  27%|██▋       | 4/15 [00:00<00:01,  7.91it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  27%|██▋       | 4/15 [00:00<00:01,  7.90it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  33%|███▎      | 5/15 [00:00<00:01,  8.45it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  33%|███▎      | 5/15 [00:00<00:01,  8.44it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  40%|████      | 6/15 [00:00<00:01,  8.86it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  40%|████      | 6/15 [00:00<00:01,  8.86it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  47%|████▋     | 7/15 [00:00<00:00,  9.18it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  47%|████▋     | 7/15 [00:00<00:00,  9.18it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  53%|█████▎    | 8/15 [00:00<00:00,  9.45it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  53%|█████▎    | 8/15 [00:00<00:00,  9.44it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  60%|██████    | 9/15 [00:00<00:00,  9.66it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  60%|██████    | 9/15 [00:00<00:00,  9.66it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  67%|██████▋   | 10/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  67%|██████▋   | 10/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  73%|███████▎  | 11/15 [00:01<00:00,  9.99it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  73%|███████▎  | 11/15 [00:01<00:00,  9.99it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  80%|████████  | 12/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  80%|████████  | 12/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  87%|████████▋ | 13/15 [00:01<00:00, 10.24it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  87%|████████▋ | 13/15 [00:01<00:00, 10.24it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7:  93%|█████████▎| 14/15 [00:01<00:00, 10.34it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:  93%|█████████▎| 14/15 [00:01<00:00, 10.34it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 7: 100%|██████████| 15/15 [00:01<00:00, 10.95it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7: 100%|██████████| 15/15 [00:01<00:00, 10.95it/s, v_num=1, valid_loss=0.647, valid_accuracy=0.634, valid_specificity=0.868, valid_AUC=0.630, valid_f1=0.513, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.49it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.44it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 41.30it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 41.27it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 41.19it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 41.09it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 43.95it/s][A
                                                                      [AEpoch 7: 100%|██████████| 15/15 [00:01<00:00,  7.74it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7, global step 120: 'valid_loss' reached 0.66089 (best 0.64653), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=07-valid_loss=0.660894-valid_accuracy=0.623617.ckpt' as top 3
Epoch 7: 100%|██████████| 15/15 [00:03<00:00,  4.49it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 7:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]         Epoch 8:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]<class 'torch.Tensor'>
Epoch 8:   7%|▋         | 1/15 [00:00<00:03,  3.69it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.515, train_accuracy=0.787, train_specificity=0.863, train_AUC=0.771, train_f1=0.725]Epoch 8:   7%|▋         | 1/15 [00:00<00:03,  3.68it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  13%|█▎        | 2/15 [00:00<00:02,  5.35it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  13%|█▎        | 2/15 [00:00<00:02,  5.34it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  20%|██        | 3/15 [00:00<00:01,  6.45it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  20%|██        | 3/15 [00:00<00:01,  6.44it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  27%|██▋       | 4/15 [00:00<00:01,  7.23it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  27%|██▋       | 4/15 [00:00<00:01,  7.23it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  33%|███▎      | 5/15 [00:00<00:01,  7.80it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  33%|███▎      | 5/15 [00:00<00:01,  7.80it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  40%|████      | 6/15 [00:00<00:01,  8.23it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  40%|████      | 6/15 [00:00<00:01,  8.23it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  47%|████▋     | 7/15 [00:00<00:00,  8.56it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  47%|████▋     | 7/15 [00:00<00:00,  8.56it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  53%|█████▎    | 8/15 [00:00<00:00,  8.84it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  53%|█████▎    | 8/15 [00:00<00:00,  8.84it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  60%|██████    | 9/15 [00:00<00:00,  9.07it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  60%|██████    | 9/15 [00:00<00:00,  9.07it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  67%|██████▋   | 10/15 [00:01<00:00,  9.27it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  67%|██████▋   | 10/15 [00:01<00:00,  9.26it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  73%|███████▎  | 11/15 [00:01<00:00,  9.44it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  73%|███████▎  | 11/15 [00:01<00:00,  9.44it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  80%|████████  | 12/15 [00:01<00:00,  9.59it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  80%|████████  | 12/15 [00:01<00:00,  9.59it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  87%|████████▋ | 13/15 [00:01<00:00,  9.73it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  87%|████████▋ | 13/15 [00:01<00:00,  9.73it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8:  93%|█████████▎| 14/15 [00:01<00:00,  9.85it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:  93%|█████████▎| 14/15 [00:01<00:00,  9.85it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 8: 100%|██████████| 15/15 [00:01<00:00, 10.43it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8: 100%|██████████| 15/15 [00:01<00:00, 10.43it/s, v_num=1, valid_loss=0.661, valid_accuracy=0.624, valid_specificity=0.903, valid_AUC=0.619, valid_f1=0.467, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.04it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 41.47it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 41.85it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.11it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.23it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.33it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.52it/s][A
                                                                      [AEpoch 8: 100%|██████████| 15/15 [00:01<00:00,  7.53it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8, global step 135: 'valid_loss' was not in top 3
Epoch 8: 100%|██████████| 15/15 [00:02<00:00,  6.05it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 8:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]         Epoch 9:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]<class 'torch.Tensor'>
Epoch 9:   7%|▋         | 1/15 [00:00<00:03,  3.70it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.510, train_accuracy=0.797, train_specificity=0.870, train_AUC=0.782, train_f1=0.740]Epoch 9:   7%|▋         | 1/15 [00:00<00:03,  3.70it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  13%|█▎        | 2/15 [00:00<00:02,  5.60it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  13%|█▎        | 2/15 [00:00<00:02,  5.59it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  20%|██        | 3/15 [00:00<00:01,  6.78it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  20%|██        | 3/15 [00:00<00:01,  6.78it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  27%|██▋       | 4/15 [00:00<00:01,  7.58it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  27%|██▋       | 4/15 [00:00<00:01,  7.57it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  33%|███▎      | 5/15 [00:00<00:01,  8.14it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  33%|███▎      | 5/15 [00:00<00:01,  8.14it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  40%|████      | 6/15 [00:00<00:01,  8.56it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  40%|████      | 6/15 [00:00<00:01,  8.56it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  47%|████▋     | 7/15 [00:00<00:00,  8.89it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  47%|████▋     | 7/15 [00:00<00:00,  8.89it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  53%|█████▎    | 8/15 [00:00<00:00,  9.17it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  53%|█████▎    | 8/15 [00:00<00:00,  9.17it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  60%|██████    | 9/15 [00:00<00:00,  9.40it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  60%|██████    | 9/15 [00:00<00:00,  9.40it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  67%|██████▋   | 10/15 [00:01<00:00,  9.59it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  67%|██████▋   | 10/15 [00:01<00:00,  9.59it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  73%|███████▎  | 11/15 [00:01<00:00,  9.76it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  73%|███████▎  | 11/15 [00:01<00:00,  9.76it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  80%|████████  | 12/15 [00:01<00:00,  9.90it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  80%|████████  | 12/15 [00:01<00:00,  9.90it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  87%|████████▋ | 13/15 [00:01<00:00, 10.02it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  87%|████████▋ | 13/15 [00:01<00:00, 10.02it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9:  93%|█████████▎| 14/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:  93%|█████████▎| 14/15 [00:01<00:00, 10.13it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 9: 100%|██████████| 15/15 [00:01<00:00, 10.71it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9: 100%|██████████| 15/15 [00:01<00:00, 10.71it/s, v_num=1, valid_loss=0.706, valid_accuracy=0.583, valid_specificity=0.938, valid_AUC=0.577, valid_f1=0.338, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.95it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 42.41it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.60it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.74it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.83it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.83it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.86it/s][A
                                                                      [AEpoch 9: 100%|██████████| 15/15 [00:01<00:00,  7.66it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9, global step 150: 'valid_loss' was not in top 3
Epoch 9: 100%|██████████| 15/15 [00:02<00:00,  6.19it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 9:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]         Epoch 10:   0%|          | 0/15 [00:00<?, ?it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]<class 'torch.Tensor'>
Epoch 10:   7%|▋         | 1/15 [00:00<00:03,  3.88it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.502, train_accuracy=0.806, train_specificity=0.877, train_AUC=0.791, train_f1=0.751]Epoch 10:   7%|▋         | 1/15 [00:00<00:03,  3.87it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  13%|█▎        | 2/15 [00:00<00:02,  5.80it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  13%|█▎        | 2/15 [00:00<00:02,  5.79it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  20%|██        | 3/15 [00:00<00:01,  6.96it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  20%|██        | 3/15 [00:00<00:01,  6.96it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  27%|██▋       | 4/15 [00:00<00:01,  7.73it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  27%|██▋       | 4/15 [00:00<00:01,  7.72it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  33%|███▎      | 5/15 [00:00<00:01,  8.27it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  33%|███▎      | 5/15 [00:00<00:01,  8.26it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  40%|████      | 6/15 [00:00<00:01,  8.68it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  40%|████      | 6/15 [00:00<00:01,  8.68it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  47%|████▋     | 7/15 [00:00<00:00,  9.00it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  47%|████▋     | 7/15 [00:00<00:00,  8.99it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  53%|█████▎    | 8/15 [00:00<00:00,  9.27it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  53%|█████▎    | 8/15 [00:00<00:00,  9.27it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  60%|██████    | 9/15 [00:00<00:00,  9.49it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  60%|██████    | 9/15 [00:00<00:00,  9.49it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  67%|██████▋   | 10/15 [00:01<00:00,  9.68it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  67%|██████▋   | 10/15 [00:01<00:00,  9.68it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  73%|███████▎  | 11/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  73%|███████▎  | 11/15 [00:01<00:00,  9.84it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  80%|████████  | 12/15 [00:01<00:00,  9.98it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  80%|████████  | 12/15 [00:01<00:00,  9.98it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  87%|████████▋ | 13/15 [00:01<00:00, 10.09it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  87%|████████▋ | 13/15 [00:01<00:00, 10.09it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10:  93%|█████████▎| 14/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10:  93%|█████████▎| 14/15 [00:01<00:00, 10.19it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]<class 'torch.Tensor'>
Epoch 10: 100%|██████████| 15/15 [00:01<00:00, 10.78it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10: 100%|██████████| 15/15 [00:01<00:00, 10.78it/s, v_num=1, valid_loss=0.716, valid_accuracy=0.572, valid_specificity=0.969, valid_AUC=0.565, valid_f1=0.270, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 0:  14%|█▍        | 1/7 [00:00<00:00, 41.41it/s][A
Validation DataLoader 0:  29%|██▊       | 2/7 [00:00<00:00, 42.13it/s][A
Validation DataLoader 0:  43%|████▎     | 3/7 [00:00<00:00, 42.41it/s][A
Validation DataLoader 0:  57%|█████▋    | 4/7 [00:00<00:00, 42.59it/s][A
Validation DataLoader 0:  71%|███████▏  | 5/7 [00:00<00:00, 42.69it/s][A
Validation DataLoader 0:  86%|████████▌ | 6/7 [00:00<00:00, 42.66it/s][A
Validation DataLoader 0: 100%|██████████| 7/7 [00:00<00:00, 45.74it/s][AMonitored metric valid_loss did not improve in the last 10 records. Best score: 0.694. Signaling Trainer to stop.

                                                                      [AEpoch 10: 100%|██████████| 15/15 [00:01<00:00,  7.77it/s, v_num=1, valid_loss=0.656, valid_accuracy=0.618, valid_specificity=0.937, valid_AUC=0.613, valid_f1=0.427, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10, global step 165: 'valid_loss' reached 0.65647 (best 0.64653), saving model to '/nfs/home/jji/Ectopics_Detection_from_PPG/checkpoints/resnet18-epoch=10-valid_loss=0.656469-valid_accuracy=0.618311.ckpt' as top 3
Epoch 10: 100%|██████████| 15/15 [00:03<00:00,  4.78it/s, v_num=1, valid_loss=0.656, valid_accuracy=0.618, valid_specificity=0.937, valid_AUC=0.613, valid_f1=0.427, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]Epoch 10: 100%|██████████| 15/15 [00:03<00:00,  4.60it/s, v_num=1, valid_loss=0.656, valid_accuracy=0.618, valid_specificity=0.937, valid_AUC=0.613, valid_f1=0.427, train_loss=0.497, train_accuracy=0.813, train_specificity=0.860, train_AUC=0.803, train_f1=0.768]
Training Done!
